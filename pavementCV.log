Using TensorFlow backend.


Run basiss.py...
args Namespace(batchsize=32, clip_mask=1, early_stopping_patience=2, epochs=1, file_list='fileloc.csv', gpu='4', loss='binary_crossentropy', max_len=1000000, mode='train', model='unet', model_weights='', n_bands=3, n_classes=2, optimizer='SGD', path='./', plot_keras_model=0, prefix='pavementCV', resize_height=-1, resize_width=-1, slice_x=400, slice_y=400, stride_x=250, stride_y=250, validation_split=0.1)
im_load_resize: ()
Date string: 2018_10_19.23-26-00

Loading files from  ./packaged_data/fileloc.csv ...
  output_size: ()
src
/root/PavementUtilizationStudy
./data/PaltoSanjose.png
3
src/./data/PaltoSanjose.png
Loading file 0 of 1
   File path: ./data/PaltoSanjose.png
   im.shape: (8046, 4684, 3)
   im.dtype: uint8
[[0 0 0 ..., 0 0 0]
 [0 0 0 ..., 0 0 0]
 [0 0 0 ..., 0 0 0]
 ..., 
 [0 0 0 ..., 0 0 0]
 [0 0 0 ..., 0 0 0]
 [0 0 0 ..., 0 0 0]]
[[1 1 1 ..., 1 1 1]
 [1 1 1 ..., 1 1 1]
 [1 1 1 ..., 1 1 1]
 ..., 
 [1 1 1 ..., 1 1 1]
 [1 1 1 ..., 1 1 1]
 [1 1 1 ..., 1 1 1]]
create np name arr..
name_arr.shape: (1,)
im_arr.shape: (1, 8046, 4684, 3)
mask_arr.shape: (1, 8046, 4684, 2)
im_arr.dtype: uint8
mask_arr.dtype: uint8
np.max(X) 255
np.max(Y) 1
Slicing images and masks...
0 im_shape: (8046, 4684, 3) mask_shape: (8046, 4684, 2)
  im_out_arr.shape; (608, 400, 400, 3)
  mask_out_arr.shape: (608, 400, 400, 2)
  mask_out_arr[0] == mask_out_arr[1]?: True
  time to slice arrays: 0.524395942688 seconds
After slicing...
 im_arr.shape: (608, 400, 400, 3)
 mask_arr.shape: (608, 400, 400, 2)
 im_arr.dtype: uint8
 mask_arr.dtype: uint8
 np.max(X) 255
 np.max(Y) 1
algo input_shape: (400, 400, 3)
UNET input shape: (400, 400, 3)
src/basiss.py:443: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("co..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=conv10)
UNET Total number of params: 7760130
Setting callbacks...
Callbacks successfully set

Check GPUs:
2018-10-19 23:26:06.025490: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2018-10-19 23:26:06.025532: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2018-10-19 23:26:06.025546: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2018-10-19 23:26:07.283276: E tensorflow/stream_executor/cuda/cuda_driver.cc:406] failed call to cuInit: CUDA_ERROR_NO_DEVICE
2018-10-19 23:26:07.283331: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:158] retrieving CUDA diagnostic information for host: b2ddf133a514
2018-10-19 23:26:07.283346: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:165] hostname: b2ddf133a514
2018-10-19 23:26:07.283788: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:189] libcuda reported version is: 390.87.0
2018-10-19 23:26:07.283839: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:369] driver version file contents: """NVRM version: NVIDIA UNIX x86_64 Kernel Module  390.87  Tue Aug 21 12:33:05 PDT 2018
GCC version:  gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.10) 
"""
2018-10-19 23:26:07.283863: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:193] kernel reported version is: 390.87.0
2018-10-19 23:26:07.283876: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:300] kernel version seems to match DSO: 390.87.0
[name: "/cpu:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 7130316364167246136
]
model_name_f ./results/pavementCV_model_final.hdf5
model_name ./results/pavementCV_model_best.hdf5
Start training...
Train on 547 samples, validate on 61 samples
Epoch 1/1
 32/547 [>.............................] - ETA: 609s - loss: 1.1327 - jaccard_coef: 0.2924 - jaccard_coef_int: 0.1941 - dice_coeff: 0.4527 - acc: 0.5832 - mean_squared_error: 0.3031 - f1_score: 0.3597 64/547 [==>...........................] - ETA: 567s - loss: 0.6989 - jaccard_coef: 0.6265 - jaccard_coef_int: 0.5774 - dice_coeff: 0.7161 - acc: 0.7816 - mean_squared_error: 0.1613 - f1_score: 0.6700 96/547 [====>.........................] - ETA: 526s - loss: 0.5389 - jaccard_coef: 0.7297 - jaccard_coef_int: 0.6968 - dice_coeff: 0.7994 - acc: 0.8457 - mean_squared_error: 0.1160 - f1_score: 0.7716128/547 [======>.......................] - ETA: 491s - loss: 1.2929 - jaccard_coef: 0.6815 - jaccard_coef_int: 0.6570 - dice_coeff: 0.7741 - acc: 0.7682 - mean_squared_error: 0.1990 - f1_score: 0.7524160/547 [=======>......................] - ETA: 453s - loss: 1.1462 - jaccard_coef: 0.7323 - jaccard_coef_int: 0.7127 - dice_coeff: 0.8126 - acc: 0.8076 - mean_squared_error: 0.1662 - f1_score: 0.7952192/547 [=========>....................] - ETA: 415s - loss: 1.0064 - jaccard_coef: 0.7708 - jaccard_coef_int: 0.7544 - dice_coeff: 0.8407 - acc: 0.8365 - mean_squared_error: 0.1417 - f1_score: 0.8262224/547 [===========>..................] - ETA: 379s - loss: 0.9132 - jaccard_coef: 0.7975 - jaccard_coef_int: 0.7835 - dice_coeff: 0.8604 - acc: 0.8567 - mean_squared_error: 0.1246 - f1_score: 0.8480256/547 [=============>................] - ETA: 342s - loss: 0.8630 - jaccard_coef: 0.8154 - jaccard_coef_int: 0.8031 - dice_coeff: 0.8740 - acc: 0.8707 - mean_squared_error: 0.1130 - f1_score: 0.8631288/547 [==============>...............] - ETA: 304s - loss: 0.8179 - jaccard_coef: 0.8300 - jaccard_coef_int: 0.8191 - dice_coeff: 0.8849 - acc: 0.8819 - mean_squared_error: 0.1036 - f1_score: 0.8753320/547 [================>.............] - ETA: 266s - loss: 0.7829 - jaccard_coef: 0.8415 - jaccard_coef_int: 0.8317 - dice_coeff: 0.8936 - acc: 0.8908 - mean_squared_error: 0.0961 - f1_score: 0.8849352/547 [==================>...........] - ETA: 229s - loss: 0.7692 - jaccard_coef: 0.8493 - jaccard_coef_int: 0.8404 - dice_coeff: 0.8998 - acc: 0.8972 - mean_squared_error: 0.0909 - f1_score: 0.8919384/547 [====================>.........] - ETA: 191s - loss: 0.7361 - jaccard_coef: 0.8582 - jaccard_coef_int: 0.8501 - dice_coeff: 0.9063 - acc: 0.9038 - mean_squared_error: 0.0853 - f1_score: 0.8991416/547 [=====================>........] - ETA: 153s - loss: 0.6986 - jaccard_coef: 0.8668 - jaccard_coef_int: 0.8593 - dice_coeff: 0.9124 - acc: 0.9100 - mean_squared_error: 0.0799 - f1_score: 0.9057448/547 [=======================>......] - ETA: 116s - loss: 0.6783 - jaccard_coef: 0.8729 - jaccard_coef_int: 0.8659 - dice_coeff: 0.9168 - acc: 0.9146 - mean_squared_error: 0.0760 - f1_score: 0.9106480/547 [=========================>....] - ETA: 78s - loss: 0.6520 - jaccard_coef: 0.8791 - jaccard_coef_int: 0.8726 - dice_coeff: 0.9212 - acc: 0.9191 - mean_squared_error: 0.0721 - f1_score: 0.9154 512/547 [===========================>..] - ETA: 41s - loss: 0.6330 - jaccard_coef: 0.8841 - jaccard_coef_int: 0.8779 - dice_coeff: 0.9248 - acc: 0.9228 - mean_squared_error: 0.0690 - f1_score: 0.9194544/547 [============================>.] - ETA: 3s - loss: 0.6190 - jaccard_coef: 0.8882 - jaccard_coef_int: 0.8824 - dice_coeff: 0.9278 - acc: 0.9259 - mean_squared_error: 0.0664 - f1_score: 0.9227 547/547 [==============================] - 660s - loss: 0.6186 - jaccard_coef: 0.8884 - jaccard_coef_int: 0.8827 - dice_coeff: 0.9280 - acc: 0.9262 - mean_squared_error: 0.0662 - f1_score: 0.9230 - val_loss: 0.4142 - val_jaccard_coef: 0.9513 - val_jaccard_coef_int: 0.9513 - val_dice_coeff: 0.9750 - val_acc: 0.9743 - val_mean_squared_error: 0.0257 - val_f1_score: 0.9750
Time to fit model: 661.304499865 seconds
Model finished saving!
