Using TensorFlow backend.


Run basiss.py...
args Namespace(batchsize=32, clip_mask=1, early_stopping_patience=2, epochs=1, file_list='fileloc.csv', gpu='4', loss='binary_crossentropy', max_len=1000000, mode='train', model='unet', model_weights='', n_bands=3, n_classes=2, optimizer='SGD', path='./', plot_keras_model=0, prefix='pavementCV', resize_height=-1, resize_width=-1, slice_x=400, slice_y=400, stride_x=250, stride_y=250, validation_split=0.1)
im_load_resize: ()
Date string: 2018_10_19.10-58-50

Loading files from  ./packaged_data/fileloc.csv ...
  output_size: ()
src
/root/PavementUtilizationStudy
./data/PaltoSanjose.png
3
src/./data/PaltoSanjose.png
Loading file 0 of 1
   File path: ./data/PaltoSanjose.png
   im.shape: (8046, 4684, 3)
   im.dtype: uint8
[[0 0 0 ..., 0 0 0]
 [0 0 0 ..., 0 0 0]
 [0 0 0 ..., 0 0 0]
 ..., 
 [0 0 0 ..., 0 0 0]
 [0 0 0 ..., 0 0 0]
 [0 0 0 ..., 0 0 0]]
[[1 1 1 ..., 1 1 1]
 [1 1 1 ..., 1 1 1]
 [1 1 1 ..., 1 1 1]
 ..., 
 [1 1 1 ..., 1 1 1]
 [1 1 1 ..., 1 1 1]
 [1 1 1 ..., 1 1 1]]
create np name arr..
name_arr.shape: (1,)
im_arr.shape: (1, 8046, 4684, 3)
mask_arr.shape: (1, 8046, 4684, 2)
im_arr.dtype: uint8
mask_arr.dtype: uint8
np.max(X) 255
np.max(Y) 1
Slicing images and masks...
0 im_shape: (8046, 4684, 3) mask_shape: (8046, 4684, 2)
  im_out_arr.shape; (608, 400, 400, 3)
  mask_out_arr.shape: (608, 400, 400, 2)
  mask_out_arr[0] == mask_out_arr[1]?: True
  time to slice arrays: 0.796833992004 seconds
After slicing...
 im_arr.shape: (608, 400, 400, 3)
 mask_arr.shape: (608, 400, 400, 2)
 im_arr.dtype: uint8
 mask_arr.dtype: uint8
 np.max(X) 255
 np.max(Y) 1
algo input_shape: (400, 400, 3)
UNET input shape: (400, 400, 3)
src/basiss.py:443: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("co..., inputs=Tensor("in...)`
  model = Model(input=inputs, output=conv10)
UNET Total number of params: 7760130
Setting callbacks...
Callbacks successfully set

Check GPUs:
2018-10-19 10:58:57.495395: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2018-10-19 10:58:57.495442: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2018-10-19 10:58:57.495462: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2018-10-19 10:58:59.359760: E tensorflow/stream_executor/cuda/cuda_driver.cc:406] failed call to cuInit: CUDA_ERROR_NO_DEVICE
2018-10-19 10:58:59.359890: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:158] retrieving CUDA diagnostic information for host: f2831fda07b2
2018-10-19 10:58:59.359916: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:165] hostname: f2831fda07b2
2018-10-19 10:58:59.360126: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:189] libcuda reported version is: 390.87.0
2018-10-19 10:58:59.360203: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:369] driver version file contents: """NVRM version: NVIDIA UNIX x86_64 Kernel Module  390.87  Tue Aug 21 12:33:05 PDT 2018
GCC version:  gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.10) 
"""
2018-10-19 10:58:59.360239: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:193] kernel reported version is: 390.87.0
2018-10-19 10:58:59.360262: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:300] kernel version seems to match DSO: 390.87.0
[name: "/cpu:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 1253090785675036398
]
model_name_f ./results/pavementCV_model_final.hdf5
model_name ./results/pavementCV_model_best.hdf5
Start training...
Train on 547 samples, validate on 61 samples
Epoch 1/1
 32/547 [>.............................] - ETA: 951s - loss: 4.8807 - jaccard_coef: 0.5192 - jaccard_coef_int: 0.5202 - dice_coeff: 0.6835 - acc: 0.5182 - mean_squared_error: 0.4764 - f1_score: 0.6826 64/547 [==>...........................] - ETA: 888s - loss: 6.5496 - jaccard_coef: 0.2597 - jaccard_coef_int: 0.2601 - dice_coeff: 0.3419 - acc: 0.4993 - mean_squared_error: 0.4979 - f1_score: 0.3413 96/547 [====>.........................] - ETA: 832s - loss: 4.4864 - jaccard_coef: 0.4922 - jaccard_coef_int: 0.4925 - dice_coeff: 0.5540 - acc: 0.6588 - mean_squared_error: 0.3394 - f1_score: 0.5536128/547 [======>.......................] - ETA: 774s - loss: 3.4807 - jaccard_coef: 0.6056 - jaccard_coef_int: 0.6058 - dice_coeff: 0.6585 - acc: 0.7369 - mean_squared_error: 0.2617 - f1_score: 0.6582160/547 [=======>......................] - ETA: 712s - loss: 2.8730 - jaccard_coef: 0.6741 - jaccard_coef_int: 0.6743 - dice_coeff: 0.7214 - acc: 0.7840 - mean_squared_error: 0.2149 - f1_score: 0.7212192/547 [=========>....................] - ETA: 653s - loss: 2.4820 - jaccard_coef: 0.7182 - jaccard_coef_int: 0.7184 - dice_coeff: 0.7626 - acc: 0.8146 - mean_squared_error: 0.1845 - f1_score: 0.7624224/547 [===========>..................] - ETA: 594s - loss: 2.2083 - jaccard_coef: 0.7491 - jaccard_coef_int: 0.7493 - dice_coeff: 0.7917 - acc: 0.8360 - mean_squared_error: 0.1632 - f1_score: 0.7915256/547 [=============>................] - ETA: 534s - loss: 1.9756 - jaccard_coef: 0.7753 - jaccard_coef_int: 0.7755 - dice_coeff: 0.8151 - acc: 0.8538 - mean_squared_error: 0.1455 - f1_score: 0.8149288/547 [==============>...............] - ETA: 475s - loss: 1.7889 - jaccard_coef: 0.7964 - jaccard_coef_int: 0.7965 - dice_coeff: 0.8336 - acc: 0.8680 - mean_squared_error: 0.1313 - f1_score: 0.8335320/547 [================>.............] - ETA: 416s - loss: 1.6403 - jaccard_coef: 0.8131 - jaccard_coef_int: 0.8132 - dice_coeff: 0.8484 - acc: 0.8794 - mean_squared_error: 0.1201 - f1_score: 0.8483352/547 [==================>...........] - ETA: 357s - loss: 1.5315 - jaccard_coef: 0.8254 - jaccard_coef_int: 0.8255 - dice_coeff: 0.8598 - acc: 0.8878 - mean_squared_error: 0.1117 - f1_score: 0.8597384/547 [====================>.........] - ETA: 297s - loss: 1.4374 - jaccard_coef: 0.8360 - jaccard_coef_int: 0.8361 - dice_coeff: 0.8694 - acc: 0.8951 - mean_squared_error: 0.1044 - f1_score: 0.8693416/547 [=====================>........] - ETA: 239s - loss: 1.3623 - jaccard_coef: 0.8445 - jaccard_coef_int: 0.8446 - dice_coeff: 0.8773 - acc: 0.9010 - mean_squared_error: 0.0986 - f1_score: 0.8772448/547 [=======================>......] - ETA: 180s - loss: 1.2894 - jaccard_coef: 0.8527 - jaccard_coef_int: 0.8528 - dice_coeff: 0.8846 - acc: 0.9065 - mean_squared_error: 0.0931 - f1_score: 0.8845480/547 [=========================>....] - ETA: 122s - loss: 1.2403 - jaccard_coef: 0.8582 - jaccard_coef_int: 0.8583 - dice_coeff: 0.8901 - acc: 0.9105 - mean_squared_error: 0.0892 - f1_score: 0.8900512/547 [===========================>..] - ETA: 64s - loss: 1.1770 - jaccard_coef: 0.8654 - jaccard_coef_int: 0.8655 - dice_coeff: 0.8961 - acc: 0.9152 - mean_squared_error: 0.0845 - f1_score: 0.8960 544/547 [============================>.] - ETA: 5s - loss: 1.1304 - jaccard_coef: 0.8706 - jaccard_coef_int: 0.8707 - dice_coeff: 0.9008 - acc: 0.9188 - mean_squared_error: 0.0809 - f1_score: 0.9008 547/547 [==============================] - 1032s - loss: 1.1325 - jaccard_coef: 0.8705 - jaccard_coef_int: 0.8706 - dice_coeff: 0.9009 - acc: 0.9187 - mean_squared_error: 0.0810 - f1_score: 0.9008 - val_loss: 0.4142 - val_jaccard_coef: 0.9512 - val_jaccard_coef_int: 0.9513 - val_dice_coeff: 0.9749 - val_acc: 0.9743 - val_mean_squared_error: 0.0257 - val_f1_score: 0.9749
Time to fit model: 1032.91429496 seconds
............] - ETA: 942s - loss: 7.7027 - jaccard_coef: 0.5167 - jaccard_coef_int: 0.5167 - dice_coeff: 0.6813 - acc: 0.5167 - mean_squared_error: 0.4833 - f1_score: 0.6813 64/547 [==>...........................] - ETA: 887s - loss: 7.6317 - jaccard_coef: 0.5211 - jaccard_coef_int: 0.5211 - dice_coeff: 0.6851 - acc: 0.5211 - mean_squared_error: 0.4789 - f1_score: 0.6851 96/547 [====>.........................] - ETA: 768s - loss: 7.5519 - jaccard_coef: 0.5261 - jaccard_coef_int: 0.5261 - dice_coeff: 0.6894 - acc: 0.5261 - mean_squared_error: 0.4739 - f1_score: 0.6894128/547 [======>.......................] - ETA: 662s - loss: 7.5761 - jaccard_coef: 0.5245 - jaccard_coef_int: 0.5245 - dice_coeff: 0.6881 - acc: 0.5245 - mean_squared_error: 0.4754 - f1_score: 0.6881160/547 [=======>......................] - ETA: 580s - loss: 7.5917 - jaccard_coef: 0.5236 - jaccard_coef_int: 0.5236 - dice_coeff: 0.6873 - acc: 0.5236 - mean_squared_error: 0.4764 - f1_score: 0.6873192/547 [=========>....................] - ETA: 513s - loss: 7.5894 - jaccard_coef: 0.5237 - jaccard_coef_int: 0.5237 - dice_coeff: 0.6874 - acc: 0.5237 - mean_squared_error: 0.4763 - f1_score: 0.6874224/547 [===========>..................] - ETA: 454s - loss: 7.5639 - jaccard_coef: 0.5252 - jaccard_coef_int: 0.5252 - dice_coeff: 0.6887 - acc: 0.5252 - mean_squared_error: 0.4748 - f1_score: 0.6887256/547 [=============>................] - ETA: 401s - loss: 7.5439 - jaccard_coef: 0.5264 - jaccard_coef_int: 0.5264 - dice_coeff: 0.6897 - acc: 0.5264 - mean_squared_error: 0.4736 - f1_score: 0.6897288/547 [==============>...............] - ETA: 351s - loss: 7.5487 - jaccard_coef: 0.5259 - jaccard_coef_int: 0.5259 - dice_coeff: 0.6892 - acc: 0.5260 - mean_squared_error: 0.4740 - f1_score: 0.6892320/547 [================>.............] - ETA: 303s - loss: 7.1558 - jaccard_coef: 0.5309 - jaccard_coef_int: 0.5309 - dice_coeff: 0.6933 - acc: 0.5353 - mean_squared_error: 0.4627 - f1_score: 0.6931352/547 [==================>...........] - ETA: 258s - loss: 6.5426 - jaccard_coef: 0.5691 - jaccard_coef_int: 0.5692 - dice_coeff: 0.7189 - acc: 0.5752 - mean_squared_error: 0.4230 - f1_score: 0.7187384/547 [====================>.........] - ETA: 214s - loss: 6.0555 - jaccard_coef: 0.5984 - jaccard_coef_int: 0.5984 - dice_coeff: 0.7389 - acc: 0.6070 - mean_squared_error: 0.3913 - f1_score: 0.7387416/547 [=====================>........] - ETA: 170s - loss: 5.6157 - jaccard_coef: 0.6262 - jaccard_coef_int: 0.6262 - dice_coeff: 0.7574 - acc: 0.6356 - mean_squared_error: 0.3628 - f1_score: 0.7572448/547 [=======================>......] - ETA: 128s - loss: 5.2359 - jaccard_coef: 0.6504 - jaccard_coef_int: 0.6504 - dice_coeff: 0.7734 - acc: 0.6603 - mean_squared_error: 0.3382 - f1_score: 0.7733480/547 [=========================>....] - ETA: 86s - loss: 4.9099 - jaccard_coef: 0.6710 - jaccard_coef_int: 0.6710 - dice_coeff: 0.7871 - acc: 0.6816 - mean_squared_error: 0.3171 - f1_score: 0.7870 512/547 [===========================>..] - ETA: 44s - loss: 4.6259 - jaccard_coef: 0.6888 - jaccard_coef_int: 0.6888 - dice_coeff: 0.7990 - acc: 0.7000 - mean_squared_error: 0.2987 - f1_score: 0.7989544/547 [============================>.] - ETA: 3s - loss: 4.3801 - jaccard_coef: 0.7041 - jaccard_coef_int: 0.7041 - dice_coeff: 0.8093 - acc: 0.7160 - mean_squared_error: 0.2828 - f1_score: 0.8092 547/547 [==============================] - 713s - loss: 4.3582 - jaccard_coef: 0.7054 - jaccard_coef_int: 0.7055 - dice_coeff: 0.8102 - acc: 0.7175 - mean_squared_error: 0.2814 - f1_score: 0.8101 - val_loss: 0.4142 - val_jaccard_coef: 0.9513 - val_jaccard_coef_int: 0.9513 - val_dice_coeff: 0.9750 - val_acc: 0.9743 - val_mean_squared_error: 0.0257 - val_f1_score: 0.9750
Time to fit model: 1692.80887008 seconds
